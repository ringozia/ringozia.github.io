<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sheena Ringo 47th Birthday</title>
    
    <!-- ÂºïÂÖ•Êõ¥ÊúâË¥®ÊÑüÁöÑÊòéÊúù‰Ωì -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;500;600;800&family=Zen+Old+Mincho:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --c-bg: #FDFBFB;
            --c-text: #1a1a1a;
            --c-rose: #B76E79;
            --c-rose-deep: #7a2b35;
            --c-gold: #C5A059;
            --font-main: 'Shippori Mincho', serif;
            --font-art: 'Zen Old Mincho', serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--c-bg);
            color: var(--c-text);
            width: 100vw;
            overflow-x: hidden;
            -ms-overflow-style: none; 
            scrollbar-width: none;
        }
        ::-webkit-scrollbar { display: none; }

        /* Loader */
        #loader {
            position: fixed; inset: 0; background: #fff; z-index: 10000;
            display: flex; align-items: center; justify-content: center;
            transition: opacity 0.8s;
        }
        .load-line { width: 100px; height: 1px; background: #eee; position: relative; }
        .load-prog { position: absolute; left: 0; top: 0; height: 100%; background: var(--c-rose); width: 0%; transition: width 0.5s; }

        /* --- SECTION 1: DYNAMIC RAIN (Refined) --- */
        #sec-intro {
            height: 100vh;
            width: 100vw;
            position: relative;
            overflow: hidden;
            background: #fff;
        }

        .rain-col {
            position: absolute;
            top: -20vh;
            width: 70px; /* ËæÉÂÆΩÁöÑÂàóÔºåÊõ¥ÂÖ∑ÂëºÂê∏ÊÑü */
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0.8;
            will-change: transform;
        }

        .rain-track {
            display: flex;
            flex-direction: column;
            gap: 5rem; /* Â¢ûÂ§ßÈó¥Ë∑ùÔºå‰∏çÂÜçÊã•Êå§ */
            animation: textFlow linear infinite;
        }

        .song-text {
            writing-mode: vertical-rl;
            font-family: var(--font-art);
            color: #111;
            transition: all 0.3s;
            text-shadow: 0 0 1px rgba(0,0,0,0.05);
        }
        
        /* ÁâπÊÆäÈ´ò‰∫ÆÊ†∑Âºè */
        .song-text.highlight {
            color: var(--c-rose-deep);
            font-weight: 900;
            transform: scale(1.1);
        }

        @keyframes textFlow {
            0% { transform: translateY(0); }
            100% { transform: translateY(-50%); }
        }

        #sec-intro.exit .rain-col:nth-child(odd) { transform: translateY(-120vh); transition: transform 1.2s cubic-bezier(0.6,0,0.2,1); }
        #sec-intro.exit .rain-col:nth-child(even) { transform: translateY(120vh); transition: transform 1.2s cubic-bezier(0.6,0,0.2,1); }

        .scroll-hint {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            font-size: 0.75rem; letter-spacing: 3px; color: var(--c-gold);
            animation: pulse 3s infinite;
        }
        @keyframes pulse { 50% { opacity: 0.3; } }

        /* --- SECTION 2: TIMELINE --- */
        #sec-bio {
            min-height: 100vh;
            background: #fff;
            padding: 80px 20px;
        }
        
        .tl-container {
            max-width: 600px;
            margin: 0 auto;
            border-left: 1px solid rgba(183, 110, 121, 0.2);
            padding-left: 30px;
        }

        .tl-item {
            margin-bottom: 50px;
            opacity: 0; transform: translateY(20px);
            transition: all 0.6s ease;
        }
        .tl-item.show { opacity: 1; transform: translateY(0); }

        .tl-year { font-family: var(--font-art); font-size: 1.5rem; color: var(--c-gold); line-height: 1; }
        .tl-body { margin-top: 8px; }
        .tl-title { font-size: 1.1rem; font-weight: 700; color: #333; }
        .tl-meta { font-size: 0.8rem; color: #888; margin-top: 2px; text-transform: uppercase; letter-spacing: 1px; }

        /* --- SECTION 3: LYRIC CAPSULES --- */
        #sec-disco {
            padding: 80px 0;
            background: #F8F4F5;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .marquee-row {
            display: flex;
            width: 100%;
            margin-bottom: 30px;
        }
        .marquee-move { display: flex; animation: marquee 60s linear infinite; }
        
        .capsule {
            background: #fff;
            padding: 12px 25px;
            margin: 0 10px;
            border-radius: 40px;
            font-size: 0.9rem;
            color: #555;
            font-family: var(--font-art);
            white-space: nowrap;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
            border: 1px solid transparent;
            transition: 0.3s;
            cursor: pointer;
        }
        .capsule:hover {
            border-color: var(--c-rose);
            color: var(--c-rose-deep);
            background: #fff0f2;
            transform: scale(1.05);
        }

        @keyframes marquee { to { transform: translateX(-50%); } }

        /* Metadata Popup (Fixed) */
        .meta-popup {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 85%; max-width: 400px;
            background: rgba(255,255,255,0.98);
            border: 1px solid var(--c-rose);
            box-shadow: 0 20px 50px rgba(122, 43, 53, 0.15);
            padding: 30px;
            text-align: center;
            opacity: 0; pointer-events: none;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 500;
        }
        .meta-popup.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
        
        .mp-lyric-jp { font-size: 1.1rem; font-weight: bold; margin-bottom: 8px; color: #000; font-family: var(--font-art); }
        .mp-lyric-cn { font-size: 0.9rem; color: #555; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .mp-info { font-size: 0.8rem; color: var(--c-gold); letter-spacing: 1px; line-height: 1.6; }
        .mp-title { font-size: 1.2rem; color: var(--c-rose-deep); margin-bottom: 5px; font-weight: bold; }

        /* --- SECTION 4: APPLE BLIND BOX --- */
        #sec-game {
            min-height: 100vh;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .apple-container { display: flex; flex-wrap: wrap; justify-content: center; width: 90%; max-width: 650px; }
        .apple-btn {
            font-size: 3.8rem; margin: -8px; cursor: pointer; transition: transform 0.2s;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.05));
        }
        .apple-btn:active { transform: scale(0.9); }

        /* --- SECTION 5: GRAND FINALE (Red/Gold) --- */
        #sec-finale {
            height: 100vh;
            width: 100vw;
            /* ÊõøÊç¢ÈªëËâ≤ËÉåÊôØ‰∏∫ Ê∑±ÈÖíÁ∫¢/ËÉ≠ËÑÇÁ∫¢ Ê∏êÂèò */
            background: linear-gradient(135deg, #2c0005 0%, #580e1a 50%, #7a2b35 100%);
            color: #eaddcf; /* ÊöñÁôΩÈáëËâ≤ */
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .year-counter {
            font-family: var(--font-art);
            font-size: 5rem;
            color: var(--c-gold);
            opacity: 0.8;
            font-weight: 700;
        }

        .slide-hint {
            margin-top: 20px;
            font-size: 0.8rem;
            letter-spacing: 4px;
            text-transform: uppercase;
            border-bottom: 1px solid var(--c-gold);
            padding-bottom: 5px;
            color: rgba(255,255,255,0.6);
        }

        .final-msg {
            position: absolute; inset: 0;
            display: flex; flex-direction: row-reverse;
            justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 1.5s;
        }
        .final-msg.show { opacity: 1; pointer-events: auto; }

        .jp-char {
            writing-mode: vertical-rl;
            font-size: 3.5rem;
            font-family: var(--font-art);
            margin: 0 15px;
            color: #fff;
            text-shadow: 0 0 15px rgba(197, 160, 89, 0.6);
            transform: translateY(30px); opacity: 0;
            transition: all 1s ease;
        }
        
        .en-sub {
            position: absolute; bottom: 50px; width: 100%; text-align: center;
            font-size: 0.9rem; letter-spacing: 3px; color: var(--c-gold);
            opacity: 0; transition: opacity 2s 2s;
        }

    </style>
</head>
<body>

<div id="loader">
    <div class="load-line"><div class="load-prog" id="load-prog"></div></div>
</div>

<!-- 1. Intro -->
<section id="sec-intro">
    <div id="rain-area" style="width:100%; height:100%;"></div>
    <div class="scroll-hint">SCROLL TO START</div>
</section>

<!-- 2. Bio -->
<section id="sec-bio">
    <div style="text-align:center; margin-bottom:50px; color:var(--c-rose-deep); letter-spacing:5px;">DISCOGRAPHY</div>
    <div class="tl-container" id="tl-box"></div>
</section>

<!-- 3. Lyric Cards -->
<section id="sec-disco">
    <div style="text-align:center; margin-bottom:30px; color:#999; font-size:0.8rem; letter-spacing:2px;">LYRIC FRAGMENTS</div>
    <div id="marquee-root"></div>
    
    <!-- Popup -->
    <div class="meta-popup" id="meta-popup">
        <div class="mp-title" id="mp-title"></div>
        <div class="mp-lyric-jp" id="mp-jp"></div>
        <div class="mp-lyric-cn" id="mp-cn"></div>
        <div class="mp-info">
            <span id="mp-album"></span><br>
            <span id="mp-year"></span>
        </div>
    </div>
</section>

<!-- 4. Game -->
<section id="sec-game">
    <div class="apple-container" id="apple-box"></div>
</section>

<!-- 5. Finale -->
<section id="sec-finale">
    <div class="year-counter" id="year-num">2025</div>
    <div class="slide-hint" id="slide-hint">Slide Up to 1978</div>
    
    <div class="final-msg" id="final-view">
        <div class="jp-char" style="transition-delay:0.2s">Ê§éÂêçÊûóÊ™é</div>
        <div class="jp-char" style="transition-delay:0.6s">ÂõõÂçÅ‰∏ÉÊ≠≥</div>
        <div class="jp-char" style="transition-delay:1.0s">Ë™ïÁîüÊó•</div>
        <div class="jp-char" style="transition-delay:1.4s">Âæ°ÁõÆÂá∫Â∫¶</div>
        <div class="en-sub">The Queen of Japanese Rock</div>
    </div>
</section>

<script>
    // --- MASTER DATABASE (Merged Lyrics & Info) ---
    // snippet: Page 3ÊòæÁ§∫ÁöÑÊ≠åËØçÁâáÊÆµ
    const masterDB = [
        {t:"‰∏∏„ÉéÂÜÖ„Çµ„Éá„Ç£„Çπ„ÉÜ„Ç£„ÉÉ„ÇØ", a:"ÁÑ°ÁΩ™„É¢„É©„Éà„É™„Ç¢„É†", y:1999, snippet:"Â∞ÜÊù•ÂÉß„Å´„Å™„Å£„Å¶...", j:"Â∞ÜÊù•ÂÉß„Å´„Å™„Å£„Å¶ÁµêÂ©ö„Åó„Å¶Ê¨≤„Åó„ÅÑ", c:"Â∏åÊúõÂ∞ÜÊù•Âá∫ÂÆ∂‰ª•Ê≠§ÁªìÂ©ö"},
        {t:"Âπ∏Á¶èË´ñ", a:"ÁÑ°ÁΩ™„É¢„É©„Éà„É™„Ç¢„É†", y:1998, snippet:"ÂÖâ„ÇíÊé¢„Åó„Å¶„ÅÑ„Çã", j:"Âêõ„ÅåÂÖ∂Âá¶„Å´Â±Ö„Çã‰∫ã„Åå Âπ∏Á¶è„ÅÆÊ¢ù‰ª∂", c:"‰Ω†Âú®ÈÇ£ÈáåËøô‰ª∂‰∫ã Â∞±ÊòØÂπ∏Á¶èÁöÑÊù°‰ª∂"},
        {t:"Ê≠åËàû‰ºéÁî∫„ÅÆÂ•≥Áéã", a:"ÁÑ°ÁΩ™„É¢„É©„Éà„É™„Ç¢„É†", y:1998, snippet:"„Åì„ÅÆÁî∫„ÅåÁßÅ„ÅÆÂ∫≠", j:"‰ªäÂ§ú„Åã„Çâ„ÅØ„Åì„ÅÆÁî∫„ÅåÁßÅ„ÅÆÂ∫≠", c:"‰ªäÂ§úÂºÄÂßãËøôÊù°Ë°óÂ∞±ÊòØÊàëÁöÑÂ∫≠Èô¢"},
        {t:"Êú¨ËÉΩ", a:"ÂãùË®¥„Çπ„Éà„É™„ÉÉ„Éó", y:1999, snippet:"Á¥ÑÊùü„ÅØË¶Å„Çâ„Å™„ÅÑ", j:"Á¥ÑÊùü„ÅØË¶Å„Çâ„Å™„ÅÑ„Çè Êûú„Åü„Åï„Çå„Å™„ÅÑ„Åì„Å®„Å™„Å©", c:"‰∏çÈúÄË¶Å‰ªÄ‰πàÁ∫¶ÂÆö ÂèçÊ≠£Â§ßÈÉΩ‰∏ç‰ºöÂÆûÁé∞"},
        {t:"„ÇÆ„Éñ„Çπ", a:"ÂãùË®¥„Çπ„Éà„É™„ÉÉ„Éó", y:2000, snippet:"i wanna be with u", j:"Don't U think? i wanna be with u", c:"‰Ω†‰∏çËßâÂæóÂêóÔºüÊàëÊÉ≥Âíå‰Ω†Âú®‰∏ÄËµ∑"},
        {t:"ÁΩ™„Å®ÁΩ∞", a:"ÂãùË®¥„Çπ„Éà„É™„ÉÉ„Éó", y:2000, snippet:"È†¨„ÇíÂà∫„ÅôÊúù", j:"È†¨„ÇíÂà∫„ÅôÊúù„ÅÆÂ±±ÊâãÈÄö„Çä", c:"Âà∫ÁóõËÑ∏È¢äÁöÑÊ∏ÖÊô®Â±±ÊâãÈÄö"},
        {t:"Ê≠£„Åó„ÅÑË°ó", a:"ÁÑ°ÁΩ™„É¢„É©„Éà„É™„Ç¢„É†", y:1999, snippet:"„Ç≠„Çπ„Çí„Åó„Å¶", j:"„ÅÇ„ÅÆÊó•È£õ„Å≥Âá∫„Åó„Å¶Ë°å„Å£„Å¶", c:"ÈÇ£Â§©ÊàëÈ£ûÂ•îËÄåÂá∫"},
        {t:"Êµ¥ÂÆ§", a:"ÂãùË®¥„Çπ„Éà„É™„ÉÉ„Éó", y:2000, snippet:"Ê¥ó„Å£„Å¶Âàá„Å£„Å¶", j:"Ê¥ó„Å£„Å¶Âàá„Å£„Å¶Ê∞¥„ÅÆ‰∏≠", c:"Ê¥óÂáÄÂàáÂºÄÂú®Ê∞¥‰∏≠"},
        {t:"Ëåé (STEM)", a:"Âä†ÁàæÂü∫ Á≤æÊ∂≤ Ê†ó„ÉéËä±", y:2003, snippet:"„Åù„Åì„Å´„ÅØÁ®Æ„Åå", j:"„Åù„Åì„Å´„ÅØ„ÄÅÁ®Æ„Åå„ÄÅ", c:"Âú®ÈÇ£ÈáåÔºåÊúâ‰∏ÄÈ¢óÁßçÂ≠ê"},
        {t:"Ëø∑ÂΩ©", a:"Âä†ÁàæÂü∫ Á≤æÊ∂≤ Ê†ó„ÉéËä±", y:2003, snippet:"Áúº„ÅåÂêà„ÅÜ„ÅÆ", j:"„Å≠„Åà„ÄÅÂ¶Ç‰Ωï„Åó„Å¶Áúº„ÅåÂêà„ÅÜ„ÅÆ", c:"ÂëêÔºå‰∏∫‰ΩïÁúºÁ•û‰ºö‰∫§Ê±á"},
        {t:"ÊÑèË≠ò", a:"Âä†ÁàæÂü∫ Á≤æÊ∂≤ Ê†ó„ÉéËä±", y:2003, snippet:"È†≠„ÅåÂãï„ÅÑ„Å¶„ÅÑ„Çã", j:"È†≠„ÅåÂãï„ÅÑ„Å¶„ÅÑ„Çã", c:"Â§ßËÑëÂú®ËΩ¨Âä®"},
        {t:"„Çä„Çì„Åî„ÅÆ„ÅÜ„Åü", a:"Single", y:2003, snippet:"ÁßÅ„ÅÆÂêçÂâç„Çí", j:"ÁßÅ„ÅÆÂêçÂâç„Çí„Çà„ÅèÂëº„Çì„Åß", c:"Â•ΩÂ•ΩÂëºÂî§ÊàëÁöÑÂêçÂ≠ó"},
        {t:"Áæ§ÈùíÊó•Âíå", a:"ÊïôËÇ≤ (Êù±‰∫¨‰∫ãÂ§â)", y:2004, snippet:"Êñ∞ÂÆø„ÅØË±™Èõ®", j:"Êñ∞ÂÆø„ÅØË±™Èõ®", c:"Êñ∞ÂÆø‰∏ãËµ∑‰∫ÜË±™Èõ®"},
        {t:"ÈÅ≠Èõ£", a:"ÊïôËÇ≤ (Êù±‰∫¨‰∫ãÂ§â)", y:2004, snippet:"Ëä±„ÅåÂí≤„ÅÑ„Åü„Çà", j:"„Åì„ÅÆÈÉ®Â±ã„ÅßÊò•„ÇíËøé„Åà„Å¶„ÅÑ„Çã", c:"Âú®Ëøô‰∏™ÊàøÈó¥ÈáåËøéÊù•‰∫ÜÊò•Â§©"},
        {t:"‰øÆÁæÖÂ†¥", a:"Â§ß‰∫∫ (Êù±‰∫¨‰∫ãÂ§â)", y:2005, snippet:"ÁôΩ„ÅÑÂòò", j:"„Ç®„Éî„ÇΩ„Éº„Éâ„Å™„Å©Â∏åÈáà„Åó„Å¶", c:"Â∞ÜËΩ∂‰∫ã‰ªÄ‰πàÁöÑÁ®ÄÈáäÂêß"},
        {t:"„Ç≠„É©„Éº„ÉÅ„É•„Éº„É≥", a:"Â®ØÊ•Ω (Êù±‰∫¨‰∫ãÂ§â)", y:2007, snippet:"Ë¥ÖÊ≤¢„ÅØÂë≥Êñπ", j:"Ë¥ÖÊ≤¢„ÅØÂë≥Êñπ", c:"Â•¢‰æàÊòØÂêå‰º¥"},
        {t:"ÈñÉÂÖâÂ∞ëÂ•≥", a:"Â®ØÊ•Ω (Êù±‰∫¨‰∫ãÂ§â)", y:2007, snippet:"‰ªä„ÇíÊÑü„Åò„Åü„ÅÑ", j:"ÁèæÂú®(„ÅÑ„Åæ)„ÇíÊúÄÈ´òÂÄ§„ÅßÈÄöÈÅé„Åó„Å¶", c:"‰ª•ÊúÄÈ´òÂÄºÈÄöËøáÁé∞Âú®"},
        {t:"„ÅÇ„Çä„ÅÇ„Åæ„ÇãÂØå", a:"Êó•Âá∫Âá¶", y:2009, snippet:"ÂÉï„Çâ„ÅÆÂØå", j:"ÂÉï„Çâ„ÅåÊâã„Å´„Åó„Å¶„ÅÑ„ÇãÂØå„ÅØ", c:"Êàë‰ª¨Êâã‰∏≠ÁöÑË¥¢ÂØå"},
        {t:"„Ç´„Éº„Éç„Éº„Ç∑„Éß„É≥", a:"Êó•Âá∫Âá¶", y:2011, snippet:"ÂîØ‰∏Ä„Å§", j:"ÂîØ‰∏Ä„Å§„ÄÅÂîØ‰∏Ä„Å§", c:"ÂîØ‰∏ÄÁöÑÔºåÂîØ‰∏ÄÁöÑ"},
        {t:"Ëá™Áî±„Å∏ÈÅìÈÄ£„Çå", a:"Êó•Âá∫Âá¶", y:2012, snippet:"ÈÅìÈÄ£„Çå„Åó„Å°„ÇÉ„Åà„Å∞", j:"ÈÅìÈÄ£„Çå„Åó„Å°„ÇÉ„Åà„Å∞", c:"Ëã•Áªì‰º¥ÂêåË°åÁöÑËØù"},
        {t:"NIPPON", a:"Êó•Âá∫Âá¶", y:2014, snippet:"Êó•Êú¨Êô¥„Çå", j:"‰∏áÊ≠≥ÔºÅ‰∏áÊ≠≥ÔºÅÊó•Êú¨Êô¥„Çå", c:"‰∏áÂ≤ÅÔºÅ‰∏áÂ≤ÅÔºÅÊó•Êú¨Êô¥Êúó"},
        {t:"Èï∑„ÅèÁü≠„ÅÑÁ•≠", a:"‰∏âÊØíÂè≤", y:2015, snippet:"Â§©‰∏äÂ§©‰∏ã", j:"Â§©‰∏äÂ§©‰∏ãÁπã„ÅêËä±ÁÅ´", c:"ËøûÊé•Â§©‰∏äÂ§©‰∏ãÁöÑÁÉüÁÅ´"},
        {t:"Á•ûÊßò„ÄÅ‰ªèÊßò", a:"‰∏âÊØíÂè≤", y:2015, snippet:"Âú∞Âõ£ÈßÑ„ÇíË∏è„Çì„Åß", j:"Âú∞Âõ£ÈßÑ„ÇíË∏è„Çì„Åß", c:"Ë∑∫ÁùÄËÑö"},
        {t:"‰∫∫Áîü„ÅØÂ§¢„Å†„Çâ„Åë", a:"ÈÄÜËº∏ÂÖ•", y:2017, snippet:"Â§ß‰∫∫„ÅÆÁöÜÊßò", j:"Â§ß‰∫∫„ÅÆÁöÜÊßò„Å´Êï¨ÂÖ∑", c:"Ëá¥ÂêÑ‰ΩçÂ§ß‰∫∫"},
        {t:"ÁõÆÊäú„ÅçÈÄö„Çä", a:"‰∏âÊØíÂè≤", y:2017, snippet:"Ë™∞„ÇÇÁü•„Çâ„Å™„ÅÑ", j:"Ë™∞„ÇÇÁü•„Çâ„Å™„ÅÑ", c:"Ë∞Å‰πü‰∏çÁü•ÈÅì"},
        {t:"Áç£„ÇÜ„ÅèÁ¥∞ÈÅì", a:"‰∏âÊØíÂè≤", y:2018, snippet:"„Åì„ÅÆ‰∏ñ„ÅØÁÑ°Â∏∏", j:"„Åì„ÅÆ‰∏ñ„ÅØÁÑ°Â∏∏", c:"Ëøô‰∏ñÈó¥Êó†Â∏∏"},
        {t:"ÂÖ¨ÁÑ∂„ÅÆÁßòÂØÜ", a:"„Éã„É•„Éº„Éà„É≥„ÅÆÊûóÊ™é", y:2019, snippet:"Âë≥Ë¶ã„Åó„Åü„ÅÑ", j:"Âë≥Ë¶ã„Åó„Åü„ÅÑ", c:"ÊÉ≥Ë¶ÅÂ∞ùÂ∞ùÂë≥ÈÅì"},
        {t:"È∂è„Å®Ëõá„Å®Ë±ö", a:"‰∏âÊØíÂè≤", y:2019, snippet:"‰∏âÊØí„ÇíÂñ∞„Çâ„Åà", j:"‰∏âÊØí„ÇíÂñ∞„Çâ„Åà", c:"ÂêûÂô¨‰∏âÊØí"},
        {t:"ÁßÅ„ÅØÁå´„ÅÆÁõÆ", a:"ÊîæÁîü‰ºö", y:2023, snippet:"Áå´„ÅÆÁõÆ", j:"Áï™ÁãÇ„Çè„Åõ", c:"Âá∫‰πéÊÑèÊñô"},
        {t:"„Åï„Çâ„Å∞Á¥îÊÉÖ", a:"ÊîæÁîü‰ºö", y:2023, snippet:"Á¥îÊÉÖ", j:"„Åï„Çâ„Å∞Á¥îÊÉÖ", c:"ÂÜçËßÅÁ∫ØÊÉÖ"}
    ];

    // Helper: Shuffle Array
    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    // --- INIT ---
    document.fonts.ready.then(() => {
        document.getElementById('load-prog').style.width = '100%';
        setTimeout(() => {
            document.getElementById('loader').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                initRain();
            }, 600);
        }, 800);
    });

    // --- 1. RAIN LOGIC (Non-Repetitive & Beautified) ---
    const rainArea = document.getElementById('rain-area');
    const introSec = document.getElementById('sec-intro');

    function initRain() {
        const colWidth = 80; 
        const cols = Math.ceil(window.innerWidth / colWidth);
        
        for(let i=0; i<cols; i++) {
            const col = document.createElement('div');
            col.className = 'rain-col';
            col.style.left = (i * colWidth + Math.random()*10) + 'px';
            
            const track = document.createElement('div');
            track.className = 'rain-track';
            // Slower, varying speeds
            track.style.animationDuration = (40 + Math.random()*30) + 's'; 

            // Shuffle DB for THIS column to ensure no repeats inside one strip
            const localDB = shuffle([...masterDB]);
            // Pick first 15
            const subset = localDB.slice(0, 15);
            
            let html = subset.map(item => {
                // Random Styling
                const fontSize = 1 + Math.random() * 0.8; // 1rem - 1.8rem
                const opacity = 0.3 + Math.random() * 0.7;
                const weight = Math.random() > 0.7 ? 600 : 400;
                // Highlight roughly 10%
                const isHighlight = Math.random() > 0.85;
                const hlClass = isHighlight ? 'highlight' : '';
                
                return `<span class="song-text ${hlClass}" style="font-size:${fontSize}rem; opacity:${isHighlight?1:opacity}; font-weight:${weight}">${item.t}</span>`;
            }).join('');
            
            track.innerHTML = html + html; // Loop
            col.appendChild(track);
            rainArea.appendChild(col);
            
            // Stagger
            col.style.transform = `translateY(${Math.random() * -30}vh)`;
        }
    }

    // Scroll Observer
    window.addEventListener('scroll', () => {
        if(window.scrollY > 100) introSec.classList.add('exit');
        else introSec.classList.remove('exit');
        checkBio();
    });

    // --- 2. BIO TIMELINE (Filtered Known Years) ---
    const tlBox = document.getElementById('tl-box');
    // Unique Sort
    const timelineData = [...masterDB].sort((a,b) => a.y - b.y);
    // Deduplicate logic for display if needed, but let's just list hits
    
    timelineData.forEach(item => {
        const d = document.createElement('div');
        d.className = 'tl-item';
        d.innerHTML = `
            <div class="tl-year">${item.y}</div>
            <div class="tl-body">
                <div class="tl-title">${item.t}</div>
                <div class="tl-meta">${item.a}</div>
            </div>
        `;
        tlBox.appendChild(d);
    });

    function checkBio() {
        const trigger = window.innerHeight * 0.85;
        document.querySelectorAll('.tl-item').forEach(el => {
            if(el.getBoundingClientRect().top < trigger) el.classList.add('show');
        });
    }

    // --- 3. LYRIC MARQUEE (Show Snippet -> Popup Full) ---
    const marqueeRoot = document.getElementById('marquee-root');
    const popup = document.getElementById('meta-popup');
    let popupTimer;

    function initMarquee() {
        const rows = 4; 
        for(let r=0; r<rows; r++) {
            const row = document.createElement('div');
            row.className = 'marquee-row';
            
            const move = document.createElement('div');
            move.className = 'marquee-move';
            move.style.animationDuration = (45 + r*5) + 's';
            if(r%2!==0) move.style.animationDirection = 'reverse';

            // Mix DB
            const rowData = shuffle([...masterDB]).slice(0, 15);
            let html = rowData.map(d => {
                // Store index/data
                const dataStr = encodeURIComponent(JSON.stringify(d));
                return `<div class="capsule" onclick="openPopup('${dataStr}')" onmouseenter="openPopup('${dataStr}')">${d.snippet}</div>`
            }).join('');
            
            move.innerHTML = html + html + html; 
            row.appendChild(move);
            marqueeRoot.appendChild(row);
        }
    }
    initMarquee();

    window.openPopup = function(str) {
        const data = JSON.parse(decodeURIComponent(str));
        
        document.getElementById('mp-title').innerText = data.t;
        document.getElementById('mp-jp').innerText = data.j;
        document.getElementById('mp-cn').innerText = data.c;
        document.getElementById('mp-album').innerText = "Album: " + data.a;
        document.getElementById('mp-year').innerText = "Year: " + data.y;
        
        popup.classList.add('active');
        
        clearTimeout(popupTimer);
        popupTimer = setTimeout(() => {
            popup.classList.remove('active');
        }, 3000); // 3ÁßíÂêéËá™Âä®Ê∂àÂ§±ÔºåÊàñËÄÖÁßªÂá∫Âå∫Âüü
    }

    // --- 4. GAME (Blind Box) ---
    const appleBox = document.getElementById('apple-box');
    for(let i=0; i<20; i++) {
        const a = document.createElement('div');
        a.className = 'apple-btn';
        a.innerText = 'üçé';
        a.style.transform = `rotate(${Math.random()*30-15}deg)`;
        a.onclick = () => {
            const pick = masterDB[Math.floor(Math.random()*masterDB.length)];
            const str = encodeURIComponent(JSON.stringify(pick));
            // Reuse popup
            openPopup(str);
        }
        appleBox.appendChild(a);
    }

    // --- 5. FINALE (Red Theme) ---
    const finale = document.getElementById('sec-finale');
    const yearNum = document.getElementById('year-num');
    const finalView = document.getElementById('final-view');
    const slideHint = document.getElementById('slide-hint');
    
    let year = 2025;
    let isDone = false;
    let startY = 0;

    function scrollYear(delta) {
        if(isDone) return;
        if(delta > 0) {
            year--;
            if(year <= 1978) {
                year = 1978;
                showFinal();
            }
        }
        yearNum.innerText = year;
        const p = (year-1978)/(2025-1978);
        yearNum.style.opacity = 0.1 + p*0.9;
    }

    function showFinal() {
        isDone = true;
        yearNum.style.opacity = 0;
        slideHint.style.opacity = 0;
        finalView.classList.add('show');
        
        const chars = document.querySelectorAll('.jp-char');
        chars.forEach(c => {
            c.style.opacity = 1;
            c.style.transform = 'translateY(0)';
        });
        document.querySelector('.en-sub').style.opacity = 1;
    }

    finale.addEventListener('touchstart', e => startY=e.touches[0].clientY, {passive:false});
    finale.addEventListener('touchmove', e => {
        const diff = startY - e.touches[0].clientY;
        if(diff > 5) { // Drag Up
            e.preventDefault();
            scrollYear(1);
            startY = e.touches[0].clientY;
        }
    }, {passive:false});

    finale.addEventListener('wheel', e => {
        if(e.deltaY > 0) {
            e.preventDefault();
            scrollYear(1);
        }
    }, {passive:false});

</script>
</body>
</html>
