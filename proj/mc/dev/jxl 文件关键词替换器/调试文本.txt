用py2.7+ttk库帮我写一个可视化文件操作程序（一个py文件实现）该项目优先服务于json文件（要考虑到文件中可能包含注释）。

要求如下：基本功能是重命名文件+替换文件内的关键字符串。

-------------------------
使用流程，打开界面，

①首先是选择模式：根模式/本地模式


根模式（默认选择该模式）：用户选取若干个文件，拖入界面的文件栏中，直接在源文件上修改。

本地模式：用户把待修改的文件放入程序同目录下的文件夹“inp”，修改后的文件会储存在“outp"文件夹中。

②选择是否替换文件名（默认勾选）

③选择是否内部替换（默认不勾选，如果勾选会显示另一个选项：是否额外替换）

（②和③选项可以都选，但至少选一个）

④输入关键字符串：匹配/替换为（两个输入框），第一个输入框是必填项，如果第二个输入框放空，即为删除的作用。

⑤点击执行，完毕。
------------------------
选项-是否替换文件名：勾选后，文件名根据 填入的关键词，遍历所有文件，匹配源文件名中的关键词，替换为用户填入的新关键词（需要点击最后的执行按钮执行）。（例如把文件okaaaok.json的aaa替换为bbb，那么为okbbbok.json）

选项-是否内部替换：默认不勾选，勾选后，会显示另一个选项：额外替换？（默认不勾选，勾选时，显示另外两个输入框，要求用户额外填写 匹配/替换 关键词。如果不勾选，则采用原来两个输入框中的信息）选择“内部替换”选项后，会遍历所有文件的内容，匹配文件内容并替换为用户填入的新关键词（需要点击最后的执行按钮执行）。


“所有文件”概念的不同：在选择根模式时，所有文件指的是拖入文件栏中的所有文件。选择本地模式时，所有文件指的是inp文件中的所有文件（记住在执行操作时，文件路径不能错）。

在切换为本地模式时，需要刷新文件栏中的文件。
----------------------
基本界面：

顶部是标题，标题下方是配置区域；

配置区域下方是文件列表区/文件栏（支持垂直滚动，表格形式展示，需要展示文件名、路径（太长时之间显示省略号）、操作信息），文件栏侧边有两个按钮 刷新/移除/清空（刷新就是刷新文件列表，移除就是用户点击单个文件后点击按钮能移在列表中除该文件（如果是本地模式需要同时删除inp中该文件），清空即为清空列表内全部文件（如果是本地模式需要同时删除inp中全部文件））；

文件栏下方是通知文本小字（播报反馈如 成功操作x个文件、请输入关键词！），最底部是两个按钮：匹配、执行。

点击匹配按钮时，自动检索所有文件栏中的文件，根据用户填入的匹配关键词，遍历计算文件中（这里是文件内部而不是文件名）包含多少个该关键词，随后在文件栏中相应的文件的“操作信息”下显示文本“查到到x个关键词”。

点击执行按钮时，自动检索文件栏中的全部文件，根据用户的选择以及填入的关键词，去修改文件。




/////////////////////////////////

界面没问题，但有两个问题：

无法对json文件内部进行修改，以及匹配功能也报错。能否把json的内容当作是字符串来处理，直接查找替换。

界面无法拖入文件（鼠标指针显示红色禁止图标），单个/多个文件都不行。


其他没有提及的地方不做修改或删减！！！！！！！！！！！

////////////////////////////////
根据我的描述修改我的代码：

在选择为根模式时，文件列表没有清空，请修复。

选择根模式时，弃用原有的拖拽文件的方式，改用手动复制文件（单个/多个，自动排除文件夹）然后点击粘贴文件路径按钮（只有根模式下有这个按钮），然后把复制的文件路径加入到文件列表中。


其他没有提及的地方不做修改或删减！！！！！！！！！！！

/////////////////////////

根本粘贴不了文件，按下粘贴按钮后提示说已粘贴0个文件。为什么你之前写的小样能实现，这个实现不了？粘贴后的文件为路径格式，你需要逐个文件拆分后显示在文件栏中。

顺便在标题栏最右边加个 说明按钮，点击后弹窗说明项目使用方法。

其他没有提及的地方不做修改或删减！！！！！！！！！！！

///////////////////////////////////

根据我的描述修改我的代码：

在选择为根模式时，文件列表没有清空，请修复。

选择根模式时，弃用原有的拖拽文件进入的方式，改用手动复制文件（单个/多个，自动排除文件夹）然后点击粘贴文件路径按钮（只有根模式下有这个按钮），就可以把复制的文件路径加入到文件列表中。粘贴后的文件为路径格式，需要逐个文件拆分后显示在文件栏中。

顺便在标题栏最右边加个 说明按钮，点击后弹窗说明项目使用方法。

严格遵守py2.7以及ttk格式.

其他没有提及的地方不做修改或删减！！！！！！！！！！！
//////////////////////
只能成功粘贴文本，无法粘贴被复制的文件，怎么回事？



////////////////////////
非常好，，但是界面还是不好看，重新美化，请确保初始打开的界面能完整显示所有按钮，不修改功能代码。

改成winnative 风格

/////////////////////
根据我的描述修改我的代码：

有个小问题，当开启了 内部替换  以及启用 额外替换 时，使用的输入框应该为是 额外查找/替换，而不是初始的匹配/替换 输入框。

重新美化改成winnative 风格，请确保初始打开的界面能完整显示所有按钮。

其他没有提及的地方不做修改或删减！！！！！！！！！！！


////////////////////////


功能代码没有任何问题了！！

界面风格改为xpnative。

底部的两个按钮被挤出去了，显示不全。在启用额外替换时，因为新增了输入框，界面被撑高了，底部按钮更看不到了，界面尺寸应该随着开关按钮相应的有调整才行。

其他没有提及的地方不做修改或删减！！！！！

////////////////////////////////////////

非常好，还有一个小问题。

我希望点击选中文件列表中的文件名时，按下 ctrl+c/v可以复制文件名为文本（过滤.json）。


///////////////////////////////
根据说明修改我的代码：

执行成功时，希望每个文件当前状态展示文本改为：成功替换x个关键词

说明书文本字体太小了。

本地模式应该禁止粘贴文件。


////////////////////////////////////

非常好，还有一个小问题：本地模式下，文件列表中成功修改的文件的完整路径不应该变为 outp，应该还是inp的路径。文件名也不需要改，只需要刷新文件的当前状态。根模式不改动。



//////////////////////////////

本地模式下，如果只勾选了替换文件名，执行修改后，如果某个文件名被修改了，该文件当前状态需要改为“成功修改文件名”，底部tkMessageBox也要播报： 执行完成 成功修改x个文件名。（没被修改的文件，清空其状态）

本地模式下，当修改后的文件名在outp文件中有同名文件时，新文件名需要加个后缀，如abcd.json改为abcd2.json。

本地模式下成功修改文件后，不论哪种情况下tkMessageBox最后需要加一句说明：'修改后的文件 保存在outp文件夹中'。

根模式/本地模式下 当只勾选了替换文件名时，点击底部匹配按钮的作用不再是检索文件内部的关键词，而是文件名，如果文件名包含关键词，当前状态改为：“*文件名：找到关键词！”，如果不包含：“文件名：无效关键词”。当执行修改后，如果某个文件名被修改了，该文件当前状态需要改为“成功修改文件名”，底部tkMessageBox也要播报： 执行完成 成功修改x个文件名。（没被修改的文件，清空其状态）

///////////////////////////////////////

前面说错了，不是tkMessageBox展示信息而是底部status_var文本。（'修改后的文件 保存在outp文件夹中'、“执行完成 成功修改x个文件名”这些都是放在status_var）

在点击执行按钮后，弹窗让用户确认选择，按下是之后，不必再弹出一个弹窗。

匹配按钮按下时，底部status_var不应该统计找到x处关键词，应该是：匹配完成，共找到x个文件。（文件名/文件内部、两种模式都统一说法）



///////////////////////////////


根模式下，当同时勾选了替换文件名和内部替换时，修改后的文件不应该是新建一个文件，而是在源文件上修改！先改文件内部，再重命名文件的顺序。

其他没有提及的地方不做修改或删减！！！！















